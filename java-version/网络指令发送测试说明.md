# 网络指令发送功能测试说明

## 功能概述

已实现完整的网络指令发送功能，支持TCP和UDP协议，包含以下特性：

### ✅ 已实现的功能

1. **完整的指令数据解析**
   - 格式：`指令名称|协议类型|IP地址|端口|指令内容`
   - 支持TCP和UDP协议
   - 完整的数据验证和错误处理

2. **网络通信功能**
   - TCP短连接模式（每条指令独立建立连接）
   - UDP数据包发送
   - 3秒连接/读取超时
   - 自动响应接收和显示

3. **数据格式处理**
   - 十六进制字符串自动去空格处理
   - 支持0-9、A-F字符（不区分大小写）
   - 自动处理奇数长度的十六进制字符串
   - 完整的格式验证和错误提示

4. **错误处理和验证**
   - IP地址格式验证（xxx.xxx.xxx.xxx）
   - 端口范围验证（0-65535）
   - 十六进制格式验证
   - 网络连接异常处理

## 测试方法

### 1. 使用网络调试助手测试

**推荐工具**：网络调试助手、TCP/UDP测试工具

**TCP服务器设置**：
- IP地址：192.168.5.95（或您的本机IP）
- 端口：8080
- 协议：TCP Server

**UDP服务器设置**：
- IP地址：192.168.1.100
- 端口：8080  
- 协议：UDP

### 2. 测试步骤

1. **启动网络调试助手**
   - 创建TCP服务器监听 192.168.5.95:8080
   - 创建UDP服务器监听 192.168.1.100:8080

2. **运行平板中控程序**
   - 启动程序并加载项目
   - 点击配置了"发送指令"功能的实例

3. **观察控制台输出**
   ```
   === 开始执行指令列表，指令数量: 2 ===
   执行第 1 条指令: 一路开|TCP|192.168.5.95|8080|00 01 00 00 00 06 01 06 00 00 00 01
   → 发送指令: 一路开 [TCP 192.168.5.95:8080] 数据长度: 12 字节
     十六进制数据: 00 01 00 00 00 06 01 06 00 00 00 01
     → 建立TCP连接到 192.168.5.95:8080
     ✓ TCP连接已建立
     ✓ TCP数据发送完成，已发送 12 字节
     ← 收到TCP响应: FF FF FF FF (4 字节)
     ✓ TCP连接已关闭
   ✓ 第 1 条指令执行成功
   ```

4. **验证网络调试助手接收**
   - 应该能看到接收到的十六进制数据
   - 数据内容：`00 01 00 00 00 06 01 06 00 00 00 01`

## 当前测试数据

根据project_data.json文件，当前配置的测试指令：

```json
{
  "name": "一路开",
  "protocol": "TCP", 
  "ip": "192.168.5.95",
  "port": "8080",
  "command": "00 01 00 00 00 06 01 06 00 00 00 01"
}
```

## 错误处理示例

程序会自动处理各种错误情况：

1. **连接失败**：`✗ TCP连接失败: 目标主机拒绝连接 192.168.5.95:8080`
2. **连接超时**：`✗ TCP连接超时: 192.168.5.95:8080`
3. **IP格式错误**：`✗ IP地址格式错误: 192.168.5`
4. **端口超范围**：`✗ 端口超出范围 (0-65535): 70000`
5. **十六进制错误**：`✗ 十六进制字符串包含无效字符，仅支持0-9、A-F`

## 注意事项

1. **防火墙设置**：确保目标端口未被防火墙阻止
2. **网络连通性**：确保目标IP地址可达
3. **服务器状态**：确保目标服务器正在监听指定端口
4. **数据格式**：十六进制数据支持空格分隔，程序会自动处理

## 功能特点

- ✅ 支持多指令顺序执行
- ✅ 每条指令独立处理，失败不影响后续指令
- ✅ 完整的日志输出和状态反馈
- ✅ 自动响应接收和显示
- ✅ 健壮的错误处理机制
- ✅ 符合工业控制通信标准
