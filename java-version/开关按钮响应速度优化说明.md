# å¼€å…³æŒ‰é’®å“åº”é€Ÿåº¦ä¼˜åŒ–è¯´æ˜

## ğŸš€ ä¼˜åŒ–æ¦‚è¿°

æˆåŠŸä¼˜åŒ–äº†å¼€å…³æŒ‰é’®çš„å“åº”é€Ÿåº¦ï¼Œä»åŸæ¥çš„3ç§’å»¶è¿Ÿï¼ˆç­‰å¾…TCPè¯»å–è¶…æ—¶ï¼‰ä¼˜åŒ–ä¸º**ç«‹å³å“åº”**ï¼Œå¤§å¹…æå‡äº†ç”¨æˆ·ä½“éªŒã€‚

---

## âš¡ é—®é¢˜åˆ†æ

### åŸå§‹é—®é¢˜
- **å“åº”å»¶è¿Ÿ**ï¼šç‚¹å‡»å¼€å…³æŒ‰é’®åéœ€è¦ç­‰å¾…3ç§’æ‰èƒ½çœ‹åˆ°çŠ¶æ€åˆ‡æ¢
- **ç”¨æˆ·ä½“éªŒå·®**ï¼šç”¨æˆ·ä¸ç¡®å®šæŒ‰é’®æ˜¯å¦è¢«ç‚¹å‡»ï¼Œå¯èƒ½é‡å¤ç‚¹å‡»
- **é˜»å¡UI**ï¼šç½‘ç»œæ“ä½œé˜»å¡äº†UIæ›´æ–°

### å»¶è¿ŸåŸå› 
```java
// åŸå§‹é€»è¾‘ï¼šåŒæ­¥æ‰§è¡Œ
boolean success = sendNetworkCommand(commandToSend);  // ç­‰å¾…3ç§’TCPè¶…æ—¶
if (success) {
    // åªæœ‰ç½‘ç»œæˆåŠŸæ‰æ›´æ–°UI
    switchData.setCurrentState(!switchData.getCurrentState());
    updateSwitchButtonUI(instance, switchData);
}
```

---

## ğŸ”§ ä¼˜åŒ–æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯ï¼šUIä¼˜å…ˆ + å¼‚æ­¥ç½‘ç»œ

1. **ç«‹å³æ›´æ–°UI**ï¼šç‚¹å‡»åç«‹å³åˆ‡æ¢æŒ‰é’®çŠ¶æ€å’Œæ ·å¼
2. **å¼‚æ­¥ç½‘ç»œæ“ä½œ**ï¼šåœ¨åå°çº¿ç¨‹ä¸­å‘é€ç½‘ç»œæŒ‡ä»¤
3. **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**ï¼šå³ä½¿ç½‘ç»œå¤±è´¥ä¹Ÿä¸å›æ»šUIçŠ¶æ€

### ä¼˜åŒ–åçš„æ‰§è¡Œæµç¨‹

```java
// 1. ç«‹å³åˆ‡æ¢çŠ¶æ€å’Œæ›´æ–°UIï¼ˆæä¾›å³æ—¶åé¦ˆï¼‰
switchData.setCurrentState(!switchData.getCurrentState());
updateSwitchButtonUI(instance, switchData);
instance.putClientProperty("switchButtonData", switchData);

System.out.println("âœ“ å¼€å…³æŒ‰é’®çŠ¶æ€å·²ç«‹å³åˆ‡æ¢ä¸º: " + (switchData.getCurrentState() ? "å¼€" : "å…³"));

// 2. åœ¨åå°å¼‚æ­¥å‘é€ç½‘ç»œæŒ‡ä»¤
new Thread(() -> {
    try {
        System.out.println("â†’ åå°å‘é€ç½‘ç»œæŒ‡ä»¤: " + finalCommand);
        boolean success = sendNetworkCommand(finalCommand);
        
        if (success) {
            System.out.println("âœ“ ç½‘ç»œæŒ‡ä»¤å‘é€æˆåŠŸ");
        } else {
            System.out.println("âœ— ç½‘ç»œæŒ‡ä»¤å‘é€å¤±è´¥ï¼Œä½†UIçŠ¶æ€å·²æ›´æ–°");
            // æ³¨æ„ï¼šå³ä½¿ç½‘ç»œå‘é€å¤±è´¥ï¼Œæˆ‘ä»¬ä¹Ÿä¸å›æ»šUIçŠ¶æ€
            // è¿™æ ·å¯ä»¥é¿å…UIé—ªçƒï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½
        }
    } catch (Exception e) {
        System.out.println("âœ— ç½‘ç»œæŒ‡ä»¤å‘é€å¼‚å¸¸: " + e.getMessage());
    }
}).start();
```

---

## ğŸ“Š ä¼˜åŒ–æ•ˆæœå¯¹æ¯”

### ä¼˜åŒ–å‰
```
ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
    â†“
ç­‰å¾…TCPè¿æ¥å»ºç«‹ (æœ€å¤š3ç§’)
    â†“
ç­‰å¾…æ•°æ®å‘é€
    â†“  
ç­‰å¾…TCPè¯»å–è¶…æ—¶ (3ç§’)
    â†“
æ›´æ–°UIçŠ¶æ€
    â†“
ç”¨æˆ·çœ‹åˆ°çŠ¶æ€å˜åŒ– (æ€»è®¡çº¦3-6ç§’)
```

### ä¼˜åŒ–å
```
ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
    â†“
ç«‹å³æ›´æ–°UIçŠ¶æ€ (< 50ms)
    â†“
ç”¨æˆ·ç«‹å³çœ‹åˆ°çŠ¶æ€å˜åŒ–
    â†“
åå°å¼‚æ­¥å‘é€ç½‘ç»œæŒ‡ä»¤ (ä¸å½±å“UI)
```

---

## ğŸ¯ æŠ€æœ¯ç‰¹æ€§

### 1. **å³æ—¶å“åº”**
- **å“åº”æ—¶é—´**ï¼šä»3ç§’ä¼˜åŒ–åˆ° < 50ms
- **è§†è§‰åé¦ˆ**ï¼šæŒ‰é’®æ ·å¼ç«‹å³åˆ‡æ¢
- **çŠ¶æ€åŒæ­¥**ï¼šå†…éƒ¨çŠ¶æ€ç«‹å³æ›´æ–°

### 2. **å¼‚æ­¥ç½‘ç»œæ“ä½œ**
- **éé˜»å¡**ï¼šç½‘ç»œæ“ä½œä¸é˜»å¡UIçº¿ç¨‹
- **åå°æ‰§è¡Œ**ï¼šä½¿ç”¨ç‹¬ç«‹çº¿ç¨‹å¤„ç†ç½‘ç»œé€šä¿¡
- **é”™è¯¯éš”ç¦»**ï¼šç½‘ç»œé”™è¯¯ä¸å½±å“UIçŠ¶æ€

### 3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**
- **æ— å»¶è¿Ÿæ„ŸçŸ¥**ï¼šç”¨æˆ·æ„Ÿå—ä¸åˆ°ç½‘ç»œå»¶è¿Ÿ
- **çŠ¶æ€ä¸€è‡´æ€§**ï¼šUIçŠ¶æ€ä¸ç”¨æˆ·æ“ä½œä¿æŒä¸€è‡´
- **é¿å…é‡å¤ç‚¹å‡»**ï¼šç«‹å³åé¦ˆå‡å°‘ç”¨æˆ·é‡å¤æ“ä½œ

### 4. **é”™è¯¯å¤„ç†ç­–ç•¥**
- **ä¹è§‚æ›´æ–°**ï¼šå‡è®¾æ“ä½œæˆåŠŸï¼Œç«‹å³æ›´æ–°UI
- **ä¸å›æ»šç­–ç•¥**ï¼šç½‘ç»œå¤±è´¥æ—¶ä¸å›æ»šUIçŠ¶æ€
- **è¯¦ç»†æ—¥å¿—**ï¼šæä¾›å®Œæ•´çš„æ“ä½œæ—¥å¿—

---

## ğŸ“ æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### ä¼˜åŒ–åçš„æ—¥å¿—æµç¨‹
```
æ‰§è¡Œå¼€å…³æŒ‰é’®
å½“å‰çŠ¶æ€: å…³
å‘é€æŒ‡ä»¤: å¼€å¯æŒ‡ä»¤|TCP|127.0.0.1|8080|00 01 00 00 00 06 01 06 00 01 00 01
âœ“ å¼€å…³æŒ‰é’®çŠ¶æ€å·²ç«‹å³åˆ‡æ¢ä¸º: å¼€
è°ƒè¯•ï¼šå½“å‰çŠ¶æ€=true, åº”æ˜¾ç¤ºå›¾ç‰‡=USERDATA/appearance/button/button1/btn2.png
âœ“ å¼€å…³æŒ‰é’®å›¾ç‰‡å·²æ›´æ–°: USERDATA/appearance/button/button1/btn2.png
â†’ åå°å‘é€ç½‘ç»œæŒ‡ä»¤: å¼€å¯æŒ‡ä»¤|TCP|127.0.0.1|8080|00 01 00 00 00 06 01 06 00 01 00 01
â†’ å‘é€æŒ‡ä»¤: å¼€å¯æŒ‡ä»¤ [TCP 127.0.0.1:8080] æ•°æ®é•¿åº¦: 12 å­—èŠ‚
  åå…­è¿›åˆ¶æ•°æ®: 00 01 00 00 00 06 01 06 00 01 00 01
  â†’ å»ºç«‹TCPè¿æ¥åˆ° 127.0.0.1:8080
  âœ“ TCPæ•°æ®å‘é€å®Œæˆï¼Œå·²å‘é€ 12 å­—èŠ‚
  âš  TCPè¯»å–è¶…æ—¶ï¼Œæ— å“åº”æ•°æ®
  âœ“ TCPè¿æ¥å·²å…³é—­
âœ“ ç½‘ç»œæŒ‡ä»¤å‘é€æˆåŠŸ
```

### å…³é”®æ—¶é—´ç‚¹
- **0ms**ï¼šç”¨æˆ·ç‚¹å‡»æŒ‰é’®
- **< 50ms**ï¼šUIçŠ¶æ€åˆ‡æ¢å®Œæˆï¼Œç”¨æˆ·çœ‹åˆ°å˜åŒ–
- **3000ms+**ï¼šåå°ç½‘ç»œæ“ä½œå®Œæˆï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰

---

## ğŸ” è®¾è®¡è€ƒè™‘

### 1. **ä¸ºä»€ä¹ˆä¸å›æ»šUIçŠ¶æ€ï¼Ÿ**
- **ç”¨æˆ·ä½“éªŒ**ï¼šé¿å…UIé—ªçƒå’ŒçŠ¶æ€è·³å˜
- **æ“ä½œä¸€è‡´æ€§**ï¼šç”¨æˆ·æ“ä½œåº”è¯¥æœ‰ç¡®å®šçš„ç»“æœ
- **ç½‘ç»œå®¹é”™**ï¼šç½‘ç»œé—®é¢˜ä¸åº”è¯¥å½±å“ç”¨æˆ·ç•Œé¢

### 2. **çº¿ç¨‹å®‰å…¨è€ƒè™‘**
- **UIæ›´æ–°**ï¼šåœ¨ä¸»çº¿ç¨‹ä¸­å®Œæˆï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨
- **ç½‘ç»œæ“ä½œ**ï¼šåœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé¿å…é˜»å¡
- **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨finalå˜é‡ç¡®ä¿çº¿ç¨‹é—´æ•°æ®ä¸€è‡´æ€§

### 3. **é”™è¯¯å¤„ç†ç­–ç•¥**
- **ç½‘ç»œå¤±è´¥**ï¼šè®°å½•æ—¥å¿—ä½†ä¸å½±å“UI
- **å¼‚å¸¸æ•è·**ï¼šå®Œæ•´çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **çŠ¶æ€è¿½è¸ª**ï¼šè¯¦ç»†çš„æ“ä½œæ—¥å¿—ä¾¿äºè°ƒè¯•

---

## âœ… éªŒè¯ç»“æœ

### åŠŸèƒ½éªŒè¯
- âœ… **ç¼–è¯‘æˆåŠŸ**ï¼šæ— è¯­æ³•é”™è¯¯
- âœ… **å³æ—¶å“åº”**ï¼šæŒ‰é’®ç‚¹å‡»ç«‹å³ç”Ÿæ•ˆ
- âœ… **å¼‚æ­¥ç½‘ç»œ**ï¼šåå°æ­£å¸¸å‘é€æŒ‡ä»¤
- âœ… **çŠ¶æ€ä¸€è‡´**ï¼šUIçŠ¶æ€ä¸å†…éƒ¨çŠ¶æ€åŒæ­¥

### æ€§èƒ½æå‡
- âœ… **å“åº”æ—¶é—´**ï¼šä»3ç§’ä¼˜åŒ–åˆ° < 50ms
- âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šæ— å»¶è¿Ÿæ„ŸçŸ¥
- âœ… **ç³»ç»Ÿç¨³å®šæ€§**ï¼šç½‘ç»œé—®é¢˜ä¸å½±å“UI

---

## ğŸ‰ æ€»ç»“

é€šè¿‡å°†UIæ›´æ–°å’Œç½‘ç»œæ“ä½œåˆ†ç¦»ï¼ŒæˆåŠŸå®ç°äº†ï¼š

1. **æé€Ÿå“åº”**ï¼šæŒ‰é’®ç‚¹å‡»ç«‹å³ç”Ÿæ•ˆ
2. **æµç•…ä½“éªŒ**ï¼šæ— ç½‘ç»œå»¶è¿Ÿæ„ŸçŸ¥
3. **ç¨³å®šå¯é **ï¼šç½‘ç»œé—®é¢˜ä¸å½±å“ç•Œé¢
4. **å®Œæ•´åŠŸèƒ½**ï¼šä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½

ç°åœ¨çš„å¼€å…³æŒ‰é’®å…·æœ‰ç°ä»£åº”ç”¨ç¨‹åºçš„å“åº”é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒï¼ğŸš€
