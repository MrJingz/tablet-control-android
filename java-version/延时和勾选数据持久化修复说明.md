# å»¶æ—¶å’Œå‹¾é€‰æ•°æ®æŒä¹…åŒ–ä¿®å¤è¯´æ˜

## ğŸ¯ é—®é¢˜æè¿°

**é—®é¢˜ç°è±¡**ï¼š
- å»¶æ—¶å’Œå‹¾é€‰æ•°æ®æ²¡æœ‰ä¿å­˜åœ¨ `project_data.json` æ–‡ä»¶ä¸­
- ä»ä¸»é¡µé¢è¿›å…¥ç¼–è¾‘ç•Œé¢é‡æ–°æ‰“å¼€ä¼šè¯æ¡†æ—¶ï¼Œå»¶æ—¶çŠ¶æ€ä¸ºåˆå§‹çŠ¶æ€
- å‹¾é€‰æ¡†ä¹Ÿæ˜¯åˆå§‹çŠ¶æ€ï¼Œæ— æ³•æ¢å¤ä¹‹å‰çš„é…ç½®

**æ ¹æœ¬åŸå› **ï¼š
1. **æŒ‡ä»¤å»¶æ—¶å­—æ®µç¼ºå¤±**ï¼šä¿å­˜æŒ‡ä»¤æ•°æ®æ—¶åªä¿å­˜äº†5ä¸ªåŸºæœ¬å­—æ®µï¼Œç¼ºå°‘å»¶æ—¶å­—æ®µ
2. **å®ä¾‹ç»„é…ç½®æ•°æ®ç¼ºå¤±**ï¼šå®ä¾‹ç»„çš„æŒ‡ä»¤åˆ—è¡¨å’Œå»¶æ—¶è®¾ç½®æ²¡æœ‰ä¿å­˜åˆ°JSONæ–‡ä»¶
3. **æ•°æ®åŠ è½½ä¸å®Œæ•´**ï¼šåŠ è½½æ—¶æ²¡æœ‰æ­£ç¡®æ¢å¤å»¶æ—¶å’Œå®ä¾‹ç»„é…ç½®æ•°æ®

---

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®å¤æŒ‡ä»¤æ•°æ®ä¿å­˜ - æ·»åŠ å»¶æ—¶å­—æ®µ

#### ä¿®å¤å‰ï¼ˆsaveInstanceDataæ–¹æ³•ï¼‰ï¼š
```java
// åªä¿å­˜5ä¸ªåŸºæœ¬å­—æ®µï¼Œç¼ºå°‘å»¶æ—¶
JsonObject commandObj = new JsonObject();
commandObj.addProperty("name", parts[0]);
commandObj.addProperty("protocol", parts[1]);
commandObj.addProperty("ip", parts[2]);
commandObj.addProperty("port", parts[3]);
commandObj.addProperty("command", parts[4]);
```

#### ä¿®å¤åï¼š
```java
// ä¿å­˜å®Œæ•´çš„6ä¸ªå­—æ®µï¼ŒåŒ…å«å»¶æ—¶
JsonObject commandObj = new JsonObject();
commandObj.addProperty("name", parts[0]);
commandObj.addProperty("protocol", parts[1]);
commandObj.addProperty("ip", parts[2]);
commandObj.addProperty("port", parts[3]);
commandObj.addProperty("command", parts[4]);
// ä¿å­˜å»¶æ—¶å­—æ®µ
if (parts.length >= 6) {
    commandObj.addProperty("delay", parts[5]);
} else {
    commandObj.addProperty("delay", "0");
}
```

### 2. æ·»åŠ å®ä¾‹ç»„é…ç½®æ•°æ®ä¿å­˜

#### å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨ä¿å­˜ï¼š
```java
// ä¿å­˜å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨
Object instanceGroupCommands = instance.getClientProperty("instanceGroupCommands");
if (instanceGroupCommands instanceof java.util.List) {
    com.google.gson.JsonArray groupCommandsArray = new com.google.gson.JsonArray();
    @SuppressWarnings("unchecked")
    java.util.List<String> groupCommandList = (java.util.List<String>) instanceGroupCommands;
    for (String cmd : groupCommandList) {
        groupCommandsArray.add(cmd);
    }
    instanceData.add("instanceGroupCommands", groupCommandsArray);
    System.out.println("ä¿å­˜å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨ï¼Œå…± " + groupCommandList.size() + " æ¡æŒ‡ä»¤");
}
```

#### å®ä¾‹ç»„å»¶æ—¶è®¾ç½®ä¿å­˜ï¼š
```java
// ä¿å­˜å®ä¾‹ç»„å»¶æ—¶è®¾ç½®
Object instanceGroupDelays = instance.getClientProperty("instanceGroupDelays");
if (instanceGroupDelays instanceof java.util.Map) {
    JsonObject delaysObj = new JsonObject();
    @SuppressWarnings("unchecked")
    java.util.Map<String, String> delayMap = (java.util.Map<String, String>) instanceGroupDelays;
    for (java.util.Map.Entry<String, String> entry : delayMap.entrySet()) {
        delaysObj.addProperty(entry.getKey(), entry.getValue());
    }
    instanceData.add("instanceGroupDelays", delaysObj);
    System.out.println("ä¿å­˜å®ä¾‹ç»„å»¶æ—¶è®¾ç½®ï¼Œå…± " + delayMap.size() + " æ¡å»¶æ—¶");
}
```

### 3. ä¿®å¤æ•°æ®åŠ è½½ - æ¢å¤å»¶æ—¶å­—æ®µ

#### ä¿®å¤å‰ï¼ˆloadInstanceFromDataæ–¹æ³•ï¼‰ï¼š
```java
// åªåŠ è½½5ä¸ªåŸºæœ¬å­—æ®µï¼Œç¼ºå°‘å»¶æ—¶
String commandData = String.format("%s|%s|%s|%s|%s", name, protocol, ip, port, command);
```

#### ä¿®å¤åï¼š
```java
// åŠ è½½å®Œæ•´çš„6ä¸ªå­—æ®µï¼ŒåŒ…å«å»¶æ—¶
String delay = commandObj.has("delay") ? commandObj.get("delay").getAsString() : "0";
String commandData = String.format("%s|%s|%s|%s|%s|%s", name, protocol, ip, port, command, delay);
System.out.println("åŠ è½½æŒ‡ä»¤: " + name + ", å»¶æ—¶: " + delay + "ç§’");
```

### 4. æ·»åŠ å®ä¾‹ç»„é…ç½®æ•°æ®åŠ è½½

#### å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨åŠ è½½ï¼š
```java
// åŠ è½½å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨
if (instanceData.has("instanceGroupCommands")) {
    com.google.gson.JsonArray groupCommandsArray = instanceData.getAsJsonArray("instanceGroupCommands");
    java.util.List<String> groupCommands = new java.util.ArrayList<>();
    for (int i = 0; i < groupCommandsArray.size(); i++) {
        String cmd = groupCommandsArray.get(i).getAsString();
        groupCommands.add(cmd);
    }
    instance.putClientProperty("instanceGroupCommands", groupCommands);
    System.out.println("åŠ è½½å®ä¾‹ç»„æŒ‡ä»¤åˆ—è¡¨ï¼Œå…± " + groupCommands.size() + " æ¡æŒ‡ä»¤");
}
```

#### å®ä¾‹ç»„å»¶æ—¶è®¾ç½®åŠ è½½ï¼š
```java
// åŠ è½½å®ä¾‹ç»„å»¶æ—¶è®¾ç½®
if (instanceData.has("instanceGroupDelays")) {
    JsonObject delaysObj = instanceData.getAsJsonObject("instanceGroupDelays");
    java.util.Map<String, String> delayMap = new java.util.HashMap<>();
    for (String key : delaysObj.keySet()) {
        String value = delaysObj.get(key).getAsString();
        delayMap.put(key, value);
    }
    instance.putClientProperty("instanceGroupDelays", delayMap);
    System.out.println("åŠ è½½å®ä¾‹ç»„å»¶æ—¶è®¾ç½®ï¼Œå…± " + delayMap.size() + " æ¡å»¶æ—¶");
}
```

---

## ğŸ“Š JSONæ•°æ®ç»“æ„å˜åŒ–

### ä¿®å¤å‰çš„JSONç»“æ„ï¼š
```json
{
  "pageContents": {
    "é¡µé¢1": [
      {
        "commands": [
          {
            "name": "æŒ‡ä»¤1",
            "protocol": "TCP",
            "ip": "192.168.1.100",
            "port": "8080",
            "command": "01 02 03"
            // ç¼ºå°‘ delay å­—æ®µ
          }
        ],
        "instanceGroupName": "å®ä¾‹ç»„1"
        // ç¼ºå°‘ instanceGroupCommands å’Œ instanceGroupDelays
      }
    ]
  }
}
```

### ä¿®å¤åçš„JSONç»“æ„ï¼š
```json
{
  "pageContents": {
    "é¡µé¢1": [
      {
        "commands": [
          {
            "name": "æŒ‡ä»¤1",
            "protocol": "TCP",
            "ip": "192.168.1.100",
            "port": "8080",
            "command": "01 02 03",
            "delay": "2.5"
          }
        ],
        "instanceGroupName": "å®ä¾‹ç»„1",
        "instanceGroupCommands": [
          "æŒ‡ä»¤1|TCP|192.168.1.100|8080|01 02 03|2.5",
          "æŒ‡ä»¤2|UDP|192.168.1.101|9090|04 05 06|1.0"
        ],
        "instanceGroupDelays": {
          "æŒ‡ä»¤1": "2.5",
          "æŒ‡ä»¤2": "1.0"
        }
      }
    ]
  }
}
```

---

## âœ… ä¿®å¤æ•ˆæœ

### æ•°æ®æŒä¹…åŒ–å®Œæ•´æ€§
- âœ… **æŒ‡ä»¤å»¶æ—¶ä¿å­˜**ï¼šæ‰€æœ‰æŒ‡ä»¤çš„å»¶æ—¶è®¾ç½®éƒ½ä¿å­˜åˆ°JSONæ–‡ä»¶
- âœ… **å®ä¾‹ç»„é…ç½®ä¿å­˜**ï¼šå®ä¾‹ç»„çš„æŒ‡ä»¤åˆ—è¡¨å’Œå»¶æ—¶è®¾ç½®å®Œæ•´ä¿å­˜
- âœ… **å‘åå…¼å®¹**ï¼šæ”¯æŒæ—§æ ¼å¼æ•°æ®çš„åŠ è½½å’Œè½¬æ¢
- âœ… **æ•°æ®å®Œæ•´æ€§**ï¼šç¡®ä¿æ‰€æœ‰é…ç½®æ•°æ®éƒ½èƒ½æ­£ç¡®æŒä¹…åŒ–

### çŠ¶æ€æ¢å¤åŠŸèƒ½
- âœ… **å»¶æ—¶çŠ¶æ€æ¢å¤**ï¼šé‡æ–°æ‰“å¼€ç•Œé¢æ—¶ï¼Œå»¶æ—¶è®¾ç½®æ­£ç¡®æ¢å¤
- âœ… **å‹¾é€‰çŠ¶æ€æ¢å¤**ï¼šå®ä¾‹ç»„é…ç½®çš„å‹¾é€‰çŠ¶æ€æ­£ç¡®æ¢å¤
- âœ… **ç‹¬ç«‹æ•°æ®ç®¡ç†**ï¼šæŒ‡ä»¤åˆ—è¡¨ç®¡ç†å’Œå®ä¾‹ç»„é…ç½®çš„å»¶æ—¶è®¾ç½®ç‹¬ç«‹å­˜å‚¨
- âœ… **å®æ—¶åŒæ­¥**ï¼šé…ç½®å˜åŒ–ç«‹å³ä¿å­˜åˆ°æ–‡ä»¶

### è°ƒè¯•æ”¯æŒ
- âœ… **è¯¦ç»†æ—¥å¿—**ï¼šä¿å­˜å’ŒåŠ è½½è¿‡ç¨‹éƒ½æœ‰è¯¦ç»†çš„è°ƒè¯•è¾“å‡º
- âœ… **æ•°æ®éªŒè¯**ï¼šå¯ä»¥æ¸…æ¥šçœ‹åˆ°ä¿å­˜å’Œæ¢å¤çš„æ•°æ®å†…å®¹
- âœ… **é—®é¢˜å®šä½**ï¼šä¾¿äºå¿«é€Ÿå‘ç°å’Œè§£å†³æ•°æ®æŒä¹…åŒ–é—®é¢˜

---

## ğŸ¯ ä½¿ç”¨éªŒè¯

### æµ‹è¯•å»¶æ—¶æ•°æ®æŒä¹…åŒ–
1. åœ¨æŒ‡ä»¤åˆ—è¡¨ç®¡ç†ä¸­è®¾ç½®æŒ‡ä»¤å»¶æ—¶
2. ç‚¹å‡»"ä¿å­˜"æŒ‰é’®ä¿å­˜é¡¹ç›®æ•°æ®
3. é‡å¯åº”ç”¨ç¨‹åºæˆ–åˆ‡æ¢åˆ°ä¸»é¡µé¢å†å›åˆ°ç¼–è¾‘ç•Œé¢
4. é‡æ–°æ‰“å¼€æŒ‡ä»¤åˆ—è¡¨ç®¡ç†ï¼ŒéªŒè¯å»¶æ—¶è®¾ç½®æ˜¯å¦ä¿æŒ

### æµ‹è¯•å®ä¾‹ç»„é…ç½®æŒä¹…åŒ–
1. é…ç½®å®ä¾‹ç»„ï¼Œé€‰æ‹©æŒ‡ä»¤å¹¶è®¾ç½®å»¶æ—¶
2. ç‚¹å‡»"ç¡®å®š"ä¿å­˜å®ä¾‹ç»„é…ç½®
3. ç‚¹å‡»"ä¿å­˜"æŒ‰é’®ä¿å­˜é¡¹ç›®æ•°æ®
4. é‡å¯åº”ç”¨ç¨‹åºæˆ–åˆ‡æ¢åˆ°ä¸»é¡µé¢å†å›åˆ°ç¼–è¾‘ç•Œé¢
5. é‡æ–°æ‰“å¼€å®ä¾‹ç»„é…ç½®ï¼ŒéªŒè¯å‹¾é€‰çŠ¶æ€å’Œå»¶æ—¶è®¾ç½®æ˜¯å¦ä¿æŒ

### éªŒè¯JSONæ–‡ä»¶å†…å®¹
1. é…ç½®å®Œæˆåï¼ŒæŸ¥çœ‹ `USERDATA/project_data.json` æ–‡ä»¶
2. ç¡®è®¤æ–‡ä»¶ä¸­åŒ…å« `delay` å­—æ®µã€`instanceGroupCommands` å’Œ `instanceGroupDelays` å­—æ®µ
3. éªŒè¯æ•°æ®æ ¼å¼æ­£ç¡®ï¼Œå†…å®¹å®Œæ•´

---

## ğŸ‰ æ€»ç»“

### ä¸»è¦æˆå°±
1. **å®Œæ•´çš„æ•°æ®æŒä¹…åŒ–**ï¼šæ‰€æœ‰å»¶æ—¶å’Œå‹¾é€‰é…ç½®éƒ½èƒ½æ­£ç¡®ä¿å­˜å’Œæ¢å¤
2. **ç‹¬ç«‹çš„æ•°æ®ç®¡ç†**ï¼šæŒ‡ä»¤åˆ—è¡¨ç®¡ç†å’Œå®ä¾‹ç»„é…ç½®ä½¿ç”¨ç‹¬ç«‹çš„å­˜å‚¨æœºåˆ¶
3. **å‘åå…¼å®¹æ€§**ï¼šæ”¯æŒæ—§æ ¼å¼æ•°æ®çš„åŠ è½½å’Œè‡ªåŠ¨è½¬æ¢
4. **å®Œå–„çš„è°ƒè¯•æ”¯æŒ**ï¼šè¯¦ç»†çš„æ—¥å¿—è¾“å‡ºä¾¿äºé—®é¢˜æ’æŸ¥

### æŠ€æœ¯äº®ç‚¹
- **æ‰©å±•çš„JSONç»“æ„**ï¼šå¢åŠ äº†å»¶æ—¶å’Œå®ä¾‹ç»„é…ç½®å­—æ®µ
- **æ™ºèƒ½æ•°æ®è½¬æ¢**ï¼šè‡ªåŠ¨å¤„ç†æ–°æ—§æ ¼å¼çš„æ•°æ®è½¬æ¢
- **å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸ**ï¼šä»ä¿å­˜åˆ°åŠ è½½çš„å®Œæ•´æ•°æ®æµç¨‹
- **ç‹¬ç«‹å­˜å‚¨æœºåˆ¶**ï¼šé¿å…ä¸åŒæ¨¡å—é—´çš„æ•°æ®å¹²æ‰°

### ç”¨æˆ·ä»·å€¼
- **é…ç½®æŒä¹…åŒ–**ï¼šç”¨æˆ·çš„æ‰€æœ‰é…ç½®éƒ½èƒ½å¯é ä¿å­˜
- **çŠ¶æ€æ¢å¤**ï¼šé‡æ–°æ‰“å¼€ç•Œé¢æ—¶é…ç½®çŠ¶æ€å®Œæ•´æ¢å¤
- **æ•°æ®å®‰å…¨**ï¼šä¸ä¼šå› ä¸ºç¨‹åºé‡å¯è€Œä¸¢å¤±é…ç½®
- **ä½¿ç”¨ä¾¿æ·**ï¼šæ— éœ€é‡å¤é…ç½®ï¼Œæå‡å·¥ä½œæ•ˆç‡

ç°åœ¨çš„ç³»ç»Ÿå…·æœ‰ï¼š
- âœ… **å®Œæ•´çš„æ•°æ®æŒä¹…åŒ–æœºåˆ¶**ï¼šæ‰€æœ‰é…ç½®éƒ½èƒ½æ­£ç¡®ä¿å­˜åˆ°JSONæ–‡ä»¶
- âœ… **å¯é çš„çŠ¶æ€æ¢å¤åŠŸèƒ½**ï¼šé‡æ–°æ‰“å¼€ç•Œé¢æ—¶çŠ¶æ€å®Œæ•´æ¢å¤
- âœ… **ç‹¬ç«‹çš„æ•°æ®ç®¡ç†**ï¼šä¸åŒæ¨¡å—çš„é…ç½®äº’ä¸å¹²æ‰°
- âœ… **å®Œå–„çš„å‘åå…¼å®¹æ€§**ï¼šæ”¯æŒæ—§æ•°æ®æ ¼å¼çš„è‡ªåŠ¨è½¬æ¢

è¿™ä¸ªä¿®å¤ç¡®ä¿äº†ç”¨æˆ·é…ç½®çš„å®Œæ•´æ€§å’ŒæŒä¹…æ€§ï¼ğŸš€
